(()=>{"use strict";var e=function(e,r){return void 0===e&&(e={}),void 0===r&&(r=[]),Object.keys(e).filter((n=>r.includes(e[n].name))).map((r=>e[r]))};function r(e,r,n,t,i,o,a){try{var l=e[o](a),s=l.value}catch(e){return void n(e)}l.done?r(s):Promise.resolve(s).then(t,i)}var n="data-loaded",t="data-has-error",i=e=>new Promise(((r,i)=>{var o=(e,r)=>{r&&r.setAttribute(t,""),i(e)};if(e){var a=e.getObj||(()=>globalThis[e.name]);if(a())r(a());else{var l=document.querySelector('script[src="'+e.url+'"]');if(l||(l=(e=>{var r=document.createElement("script");return r.setAttribute("src",e),r.setAttribute("async",!0),document.head.appendChild(r),r})(e.url)),l){var s=l.hasAttribute(t),u=l.hasAttribute(n);s||u?s?o(new Error("load error")):r(a()):(l.addEventListener("load",(()=>{l.setAttribute(n,""),r(a())}),{once:!0}),l.addEventListener("error",(e=>{o(e,l)}),{once:!0}))}else o(new Error("no script element"))}}else o(new Error("no config"))})),o=function(){var n,t=(n=function*(r,n,t){void 0===t&&(t=!1);var o=n?e(r,n):function(e){return void 0===e&&(e={}),Object.keys(e).filter((r=>!!e[r].pluginName)).map((r=>e[r]))}(r),a=[];try{yield Promise.all([...o.map((e=>i(e).catch((r=>{a.push(e.name),console.error("[playerAssets::getAsset] "+e.url,r)}))))])}catch(e){console.error(e)}var l=o.filter((e=>!a.includes(e.name))),s=function(e,r){return void 0===e&&(e=[]),void 0===r&&(r=!1),e.filter((e=>r?!!e.isContainer:!e.isContainer)).map((e=>((e,r)=>{var n=r=>{var n;try{var t=globalThis[e.name];e.isDefault&&t&&(t=globalThis[e.name].default);var i=e.needsClappr?globalThis.Clappr:void 0;n=t?t(r||i):void 0}catch(e){console.error(e)}return n};return r?n():n})(e,t))).filter((e=>!!e))};return{core:[...s(l)],container:[...s(l,!0)]}},function(){var e=this,t=arguments;return new Promise((function(i,o){var a=n.apply(e,t);function l(e){r(a,i,o,l,s,"next",e)}function s(e){r(a,i,o,l,s,"throw",e)}l(void 0)}))});return function(e,r,n){return t.apply(this,arguments)}}(),a="video_perf",l=e=>{var r;return e-((null==globalThis||null==(r=globalThis.glbDebug)?void 0:r.firstTick)||0)},s=function(e,r,n,t,i){void 0===t&&(t=null),void 0===i&&(i=null),globalThis.HorizonClient&&globalThis.HorizonClient.then((o=>{o.send({id:"common-event",version:"0.1",contentType:"common",properties:{eventCategory:e,eventAction:r,eventLabel:t,eventValue:n,eventProperty:i}})})).catch((e=>{console.error(e)}))};function u(){return u=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},u.apply(this,arguments)}function c(e,r,n,t,i,o,a){try{var l=e[o](a),s=l.value}catch(e){return void n(e)}l.done?r(s):Promise.resolve(s).then(t,i)}function v(e){return function(){var r=this,n=arguments;return new Promise((function(t,i){var o=e.apply(r,n);function a(e){c(o,t,i,a,l,"next",e)}function l(e){c(o,t,i,a,l,"throw",e)}a(void 0)}))}}var f={profiles:[]},p=function(){var e=v((function*(e){var r,n;void 0===e&&(e={}),f.profiles=[],f.config=JSON.parse(JSON.stringify(e)),globalThis.promiseResolvePlayerAssets&&globalThis.promiseResolvePlayerAssets(),(n=i(null==(r=f.config)?void 0:r.WM))&&n.then((()=>{s(a,"player_api_available",l(Date.now())),setTimeout((()=>{globalThis.WM&&globalThis.WM.playerAvailable&&globalThis.WM.playerAvailable.then((()=>{s(a,"player_available",l(Date.now()))})).catch((e=>{console.error(e)}))}),10)})).catch((e=>{console.error(e)}))}));return function(r){return e.apply(this,arguments)}}(),d=e=>f.profiles.find((r=>r.profileId===e));f.init=p,f.getPlugins=function(){var e=v((function*(e,r){return void 0===r&&(r=!1),o(f.config,e,r)}));return function(r,n){return e.apply(this,arguments)}}(),f.getPluginsByProfile=function(e,r){void 0===r&&(r=!1);var n=d(e),t=n?n.pluginNames:void 0;return o(f.config,t,r)},f.getPluginConfigsByProfile=r=>{var n=d(r),t=n?n.pluginNames:void 0;return e(f.config,t)},f.getAsset=i,f.registerProfile=function(r,n){var t;if(void 0===n&&(n={}),r&&!d(r)){var i=(r=>{var n,{pluginNames:t=[]}=r,i=e(f.config,t);return i&&(n={pluginNames:i.map((e=>e.name))}),n})(n);i&&(t=u({profileId:r},i),f.profiles.push(t))}return t},globalThis.playerAssetsManager=f,f.init(globalThis.playerAssetsConfig)})();